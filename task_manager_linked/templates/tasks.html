{% extends "base.html" %}
{% block content %}
<h1>{% if user.is_admin %}Όλες οι Εργασίες{% else %}Οι Εργασίες μου{% endif %}</h1>
<table class="table">
  <thead>
    <tr>
      <th>#</th><th>Τίτλος</th><th>Κατάσταση</th><th>Progress</th><th>Ανατέθηκε σε</th><th>Ημ/νία</th>
    </tr>
  </thead>
  <tbody>
    {% for t in tasks %}
      <tr>
        <td>{{ t.id }}</td>
        <td>{{ t.title }}</td>
        <td>{{ t.status }}</td>
        <td>
  <form action="{{ url_for('task_update_progress', task_id=t.id) }}" method="post" style="display:flex; gap:4px">
    <input type="number" name="progress" value="{{ t.progress }}" min="0" max="100" style="width:60px">
    <button type="submit">OK</button>
  </form>
</td>
        <td>
          {% if user_map and t.assignee_id in user_map %}
            {{ user_map[t.assignee_id] }}
          {% else %}
            {{ t.assignee_id or '—' }}
          {% endif %}
        </td>
        <td>{{ t.created_at.strftime('%Y-%m-%d %H:%M') if t.created_at else '—' }}</td>
      </tr>
    {% else %}
      <tr><td colspan="6" class="muted">Δεν υπάρχουν εργασίες.</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
