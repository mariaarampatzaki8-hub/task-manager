{% extends "base.html" %}

{% block title %}Μέλη Ομάδας · {{ team.name }}{% endblock %}

{% block content %}
<h1>Μέλη Ομάδας: <strong>{{ team.name }}</strong></h1>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    <div class="flash-container">
      {% for category, message in messages %}
        <div class="flash {{ category }}">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}
{% endwith %}

<div class="actions-row">
  <a href="{{ url_for('admin_teams') }}">← Πίσω στη διαχείριση ομάδων</a>
</div>

<hr>

<h2>Προσθήκη μέλους</h2>
<form method="POST" action="{{ url_for('admin_team_members', team_id=team.id) }}" class="form-inline">
  <label for="username">Username χρήστη:</label>
  <input type="text" id="username" name="username" placeholder="π.χ. maria" required>
  <button type="submit">Προσθήκη</button>
</form>

<p class="hint">
  * Γράψε το <em>username</em> ακριβώς όπως υπάρχει στον κατάλογο χρηστών.
</p>

<hr>

<h2>Τρέχοντα μέλη</h2>
{% if team.members %}
  <table class="table">
    <thead>
      <tr>
        <th>#</th>
        <th>Username</th>
        <th>Ρόλος</th>
        <th style="width:140px;">Ενέργειες</th>
      </tr>
    </thead>
    <tbody>
      {% for m in team.members %}
      <tr>
        <td>{{ loop.index }}</td>
        <td>{{ m.username }}</td>
        <td>
          {% if m.is_admin %}
            <span class="badge badge-admin">Διαχειριστής</span>
          {% elif team.leader_id == m.id %}
            <span class="badge badge-leader">Leader</span>
          {% else %}
            Μέλος
          {% endif %}
        </td>
        <td>
          <form method="POST" action="{{ url_for('admin_team_members', team_id=team.id) }}" style="display:inline;">
            <input type="hidden" name="remove_id" value="{{ m.id }}">
            <button type="submit" onclick="return confirm('Να αφαιρεθεί ο χρήστης {{ m.username }} από την ομάδα;')">
              Αφαίρεση
            </button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <p>Δεν υπάρχουν μέλη σε αυτή την ομάδα ακόμα.</p>
{% endif %}

<style>
  .form-inline { display:flex; gap:.5rem; align-items:center; flex-wrap:wrap; }
  .form-inline input { min-width:200px; }
  .badge { padding:.1rem .4rem; border-radius:.3rem; font-size:.85em; }
  .badge-admin { background:#c62828; color:#fff; }
  .badge-leader { background:#1565c0; color:#fff; }
  .table { width:100%; border-collapse:collapse; }
  .table th, .table td { border-bottom:1px solid #eee; padding:.5rem .4rem; text-align:left; }
  .actions-row { margin:.5rem 0 1rem; }
  .hint { color:#666; font-size:.9em; }
</style>
{% endblock %}
