{% extends "base.html" %}
{% block title %}ÎŸÎ¹ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ Î¼Î¿Ï…{% endblock %}
{% block content %}

<h1 class="title" style="color:var(--accent)">Î“ÎµÎ¹Î± ÏƒÎ¿Ï…, {{ user.name }}!</h1>

<div class="columns">
  <div class="column">
    <div class="box">
      <h2 class="subtitle">ğŸŸ¡ Î‘Î½Î¿Î¹Ï‡Ï„Î­Ï‚ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚</h2>
      {% if open_tasks %}
        {% for t in open_tasks %}
          <div class="notification is-light" style="border-left:6px solid var(--accent)">
            <p><strong>{{ t.title }}</strong></p>
            {% if t.description %}<p>{{ t.description }}</p>{% endif %}
            <p class="is-size-7">
              {% if t.due_date %}Î ÏÎ¿Î¸ÎµÏƒÎ¼Î¯Î±: {{ t.due_date.strftime('%d/%m/%Y') }}{% endif %}
              {% if t.due_time %} {{ t.due_time.strftime('%H:%M') }}{% endif %}
            </p>
            <form method="post" action="{{ url_for('toggle_task', task_id=t.id) }}">
              <button class="button is-small" style="background:var(--accent);color:#fff">ÎŸÎ»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ</button>
            </form>
          </div>
        {% endfor %}
      {% else %}
        <p>Î”ÎµÎ½ Î­Ï‡ÎµÎ¹Ï‚ Î±Î½Î¿Î¹Ï‡Ï„Î­Ï‚ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ ğŸ‰</p>
      {% endif %}
    </div>
  </div>

  <div class="column">
    <div class="box">
      <h2 class="subtitle">âœ… ÎŸÎ»Î¿ÎºÎ»Î·ÏÏ‰Î¼Î­Î½ÎµÏ‚</h2>
      {% if done_tasks %}
        {% for t in done_tasks %}
          <div class="notification is-success is-light">
            <p><strong>{{ t.title }}</strong></p>
            <p class="is-size-7">ÎŸÎ»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ ÏƒÏ„Î¹Ï‚ {{ t.completed_at.strftime('%d/%m/%Y %H:%M') if t.completed_at }}</p>
            <form method="post" action="{{ url_for('toggle_task', task_id=t.id) }}">
              <button class="button is-small is-warning">Î•Ï€Î±Î½Î±Ï†Î¿ÏÎ¬</button>
            </form>
          </div>
        {% endfor %}
      {% else %}
        <p>Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î¿Î»Î¿ÎºÎ»Î·ÏÏ‰Î¼Î­Î½ÎµÏ‚ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚.</p>
      {% endif %}
    </div>
  </div>
</div>

<!-- Î¦ÏŒÏÎ¼Î± Î±Î»Î»Î±Î³Î®Ï‚ ÎºÏ‰Î´Î¹ÎºÎ¿Ï -->
<div class="box">
  <h2 class="subtitle">ğŸ”‘ Î‘Î»Î»Î±Î³Î® ÎºÏ‰Î´Î¹ÎºÎ¿Ï</h2>
  <form method="post" action="{{ url_for('me_change_password') }}">
    {% if user.password_hash %}
      <div class="field"><label class="label">Î¤ÏÎ­Ï‡Ï‰Î½ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚</label>
        <input class="input" type="password" name="current_password" required>
      </div>
    {% endif %}
    <div class="field"><label class="label">ÎÎ­Î¿Ï‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚</label>
      <input class="input" type="password" name="new_password" required>
    </div>
    <div class="field"><label class="label">Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ· Î½Î­Î¿Ï…</label>
      <input class="input" type="password" name="confirm_password" required>
    </div>
    <button class="button is-link" style="background:var(--accent)">Î‘Î»Î»Î±Î³Î®</button>
  </form>
</div>

{% endblock %}
