{% extends "base.html" %}
{% block content %}
<h1>Σημειώσεις</h1>

<!-- Φόρμα δημιουργίας νέας σημείωσης -->
<section class="note-form">
  <form action="{{ url_for('notes') }}" method="post" class="form-grid">
    <label>Τίτλος
      <input type="text" name="title" placeholder="π.χ. Αίτημα για βοήθεια">
    </label>

    <label>Περιεχόμενο
      <textarea name="body" rows="4" placeholder="Γράψε τη σημείωση σου εδώ..."></textarea>
    </label>

    <button type="submit">Αποθήκευση</button>
  </form>
</section>

<hr>

<!-- Λίστα σημειώσεων -->
<section class="notes-list">
  {% if notes and notes|length %}
    {% for note in notes %}
      {% if user.is_admin or note.author_id == user.id %}
        <article class="note-card">
          <header>
            <h3>{{ note.title }}</h3>
            <small>
              Από: {{ note.author.name or note.author.username }}
              στις {{ note.created_at.strftime("%Y-%m-%d %H:%M") if note.created_at else "—" }}
            </small>
          </header>
          <p>{{ note.body|safe }}</p>

          {% if user.is_admin %}
            <form action="{{ url_for('edit_note', note_id=note.id) }}" method="post" style="margin-top:10px;">
              <textarea name="reply" rows="2" placeholder="Απάντηση..."></textarea>
              <button type="submit">Απάντηση</button>
            </form>
          {% endif %}
        </article>
        <hr>
      {% endif %}
    {% endfor %}
  {% else %}
    <p class="muted">Δεν υπάρχουν σημειώσεις.</p>
  {% endif %}
</section>

{% endblock %}
