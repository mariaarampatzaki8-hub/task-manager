{% extends "base.html" %}
{% block title %}Î Î¯Î½Î±ÎºÎ±Ï‚ Î”Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®{% endblock %}
{% block content %}

<h1 class="title" style="color:var(--accent)">âš™ï¸ Î Î¯Î½Î±ÎºÎ±Ï‚ Î”Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®</h1>

<!-- Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÎÎ•ÎŸÎ¥ Î§Î¡Î—Î£Î¤Î— -->
<div class="box">
  <h2 class="subtitle">â• Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î½Î­Î¿Ï… Ï‡ÏÎ®ÏƒÏ„Î·</h2>
  <form method="post" action="{{ url_for('admin_create_user') }}">
    <div class="field">
      <label class="label">ÎŒÎ½Î¿Î¼Î± (Ï€.Ï‡. ÎœÎ±ÏÎ¯Î±)</label>
      <input class="input" name="name" required>
    </div>
    <div class="field">
      <label class="label">Username (Î³Î¹Î± login)</label>
      <input class="input" name="username" required>
    </div>
    <div class="field">
      <label class="label">Email (Ï€ÏÎ¿Î±Î¹ÏÎµÏ„Î¹ÎºÏŒ)</label>
      <input class="input" type="email" name="email">
    </div>
    <div class="field">
      <label class="label">Î‘ÏÏ‡Î¹ÎºÏŒÏ‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚</label>
      <input class="input" type="password" name="password" required>
    </div>
    <div class="field">
      <label class="label">Î§ÏÏÎ¼Î± Ï€ÏÎ¿Ï†Î¯Î»</label>
      <input class="input" type="color" name="color" value="#3273dc">
    </div>
    <button class="button is-link" style="background:var(--accent)">Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Ï‡ÏÎ®ÏƒÏ„Î·</button>
  </form>
</div>

<!-- Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î•Î¡Î“Î‘Î£Î™Î‘Î£ -->
<div class="box">
  <h2 class="subtitle">ğŸ“ Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î½Î­Î±Ï‚ ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚</h2>
  <form method="post" action="{{ url_for('admin_create_task') }}">
    <div class="field">
      <label class="label">Î‘Î½Î¬Î¸ÎµÏƒÎ· ÏƒÎµ</label>
      <div class="select is-fullwidth">
        <select name="assignee_id">
          <option value="">â€” ÎšÎ±Î½Î­Î½Î±Î½ â€”</option>
          {% for u in users %}
            <option value="{{ u.id }}">{{ u.name }}</option>
          {% endfor %}
        </select>
      </div>
    </div>
    <div class="field">
      <label class="label">Î¤Î¯Ï„Î»Î¿Ï‚</label>
      <input class="input" name="title" required>
    </div>
    <div class="field">
      <label class="label">Î ÎµÏÎ¹Î³ÏÎ±Ï†Î®</label>
      <textarea class="textarea" name="description"></textarea>
    </div>
    <div class="columns">
      <div class="column">
        <label class="label">Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î±</label>
        <input class="input" type="date" name="due_date">
      </div>
      <div class="column">
        <label class="label">ÎÏÎ±</label>
        <input class="input" type="time" name="due_time">
      </div>
    </div>
    <button class="button is-link" style="background:var(--accent)">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÎµÏÎ³Î±ÏƒÎ¯Î±Ï‚</button>
  </form>
</div>

<!-- Î›Î™Î£Î¤Î‘ Î§Î¡Î—Î£Î¤Î©Î -->
<div class="box">
  <h2 class="subtitle">ğŸ‘¥ Î§ÏÎ®ÏƒÏ„ÎµÏ‚</h2>
  {% if users %}
    <table class="table is-fullwidth is-striped">
      <thead>
        <tr><th>ÎŒÎ½Î¿Î¼Î±</th><th>Username</th><th>Email</th><th>Î§ÏÏÎ¼Î±</th><th>Î ÏÎ¿ÏƒÏ‰Ï€Î¹ÎºÏŒ link</th></tr>
      </thead>
      <tbody>
        {% for u in users %}
        <tr>
          <td>{{ u.name }}</td>
          <td>{{ u.username }}</td>
          <td>{{ u.email or 'â€”' }}</td>
          <td><span style="display:inline-block;width:24px;height:16px;background:{{ u.color or '#3273dc' }};border-radius:3px"></span></td>
          <td><code>/login/{{ u.token }}</code></td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Ï‡ÏÎ®ÏƒÏ„ÎµÏ‚ Î±ÎºÏŒÎ¼Î±.</p>
  {% endif %}
</div>

<!-- Î›Î™Î£Î¤Î‘ Î•Î¡Î“Î‘Î£Î™Î©Î -->
<div class="box">
  <h2 class="subtitle">ğŸ“‹ Î•ÏÎ³Î±ÏƒÎ¯ÎµÏ‚</h2>
  {% if tasks %}
    <table class="table is-fullwidth is-striped">
      <thead>
        <tr><th>Î¤Î¯Ï„Î»Î¿Ï‚</th><th>Î£Îµ Ï€Î¿Î¹Î¿Î½</th><th>Î ÏÎ¿Î¸ÎµÏƒÎ¼Î¯Î±</th><th>ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·</th></tr>
      </thead>
      <tbody>
        {% for t in tasks %}
        <tr>
          <td>{{ t.title }}</td>
          <td>{{ t.assignee.name if t.assignee else 'â€”' }}</td>
          <td>
            {% if t.due_date %}{{ t.due_date.strftime('%d/%m/%Y') }}{% endif %}
            {% if t.due_time %} {{ t.due_time.strftime('%H:%M') }}{% endif %}
          </td>
          <td>
            {% if t.status == 'done' %}
              <span class="tag is-success">ÎŸÎ»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ</span>
            {% else %}
              <span class="tag is-warning">Î‘Î½Î¿Î¹Ï‡Ï„Î®</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ Î±ÎºÏŒÎ¼Î±.</p>
  {% endif %}
</div>

{% endblock %}
