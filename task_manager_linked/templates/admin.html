{% extends "base.html" %}
{% block title %}Πίνακας Διαχειριστή{% endblock %}
{% block content %}

<h1 class="title" style="color:var(--accent)">⚙️ Πίνακας Διαχειριστή</h1>

<div class="box">
  <h2 class="subtitle">Δημιουργία νέου χρήστη</h2>
  <form method="post" action="{{ url_for('admin_create_user') }}">
    <div class="field">
      <label class="label">Όνομα Χρήστη</label>
      <input class="input" name="username" required>
    </div>
    <div class="field">
      <label class="label">Email</label>
      <input class="input" type="email" name="email" required>
    </div>
    <div class="field">
      <label class="label">Κωδικός</label>
      <input class="input" type="password" name="password" required>
    </div>
    <div class="field">
      <label class="label">Χρώμα Προφίλ</label>
      <input class="input" type="color" name="color" value="#3273dc">
    </div>
    <button class="button is-primary" style="background:var(--accent)">➕ Δημιουργία</button>
  </form>
</div>

<div class="box">
  <h2 class="subtitle">Δημιουργία νέας εργασίας</h2>
  <form method="post" action="{{ url_for('admin_create_task') }}">
    <div class="field">
      <label class="label">Χρήστης</label>
      <div class="select is-fullwidth">
        <select name="user_id" required>
          {% for u in users %}
          <option value="{{ u.id }}">{{ u.name }}</option>
          {% endfor %}
        </select>
      </div>
    </div>
    <div class="field">
      <label class="label">Τίτλος</label>
      <input class="input" name="title" required>
    </div>
    <div class="field">
      <label class="label">Περιγραφή</label>
      <textarea class="textarea" name="description"></textarea>
    </div>
    <div class="field is-grouped">
      <div class="control">
        <label class="label">Ημερομηνία</label>
        <input class="input" type="date" name="due_date">
      </div>
      <div class="control">
        <label class="label">Ώρα</label>
        <input class="input" type="time" name="due_time">
      </div>
    </div>
    <button class="button is-link" style="background:var(--accent)">📌 Ανάθεση</button>
  </form>
</div>

<div class="box">
  <h2 class="subtitle">Λίστα χρηστών</h2>
  {% if users %}
    <table class="table is-fullwidth is-striped">
      <thead>
        <tr><th>Όνομα</th><th>Email</th><th>Χρώμα</th><th>Token</th></tr>
      </thead>
      <tbody>
        {% for u in users %}
        <tr>
          <td>{{ u.name }}</td>
          <td>{{ u.email }}</td>
          <td><span style="background:{{ u.color }};padding:4px 12px;border-radius:4px;color:white">{{ u.color }}</span></td>
          <td>/login/{{ u.token }}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>Δεν υπάρχουν χρήστες ακόμα.</p>
  {% endif %}
</div>

<div class="box">
  <h2 class="subtitle">Λίστα εργασιών</h2>
  {% if tasks %}
    <table class="table is-fullwidth is-striped">
      <thead>
        <tr><th>Χρήστης</th><th>Τίτλος</th><th>Προθεσμία</th><th>Κατάσταση</th></tr>
      </thead>
      <tbody>
        {% for t in tasks %}
        <tr>
          <td>{{ t.user.name }}</td>
          <td>{{ t.title }}</td>
          <td>
            {% if t.due_date %}{{ t.due_date.strftime('%d/%m/%Y') }}{% endif %}
            {% if t.due_time %} {{ t.due_time.strftime('%H:%M') }}{% endif %}
          </td>
          <td>
            {% if t.status == 'done' %}
              <span class="tag is-success">Ολοκληρώθηκε</span>
            {% else %}
              <span class="tag is-warning">Ανοιχτή</span>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>Δεν υπάρχουν εργασίες ακόμα.</p>
  {% endif %}
</div>

{% endblock %}
