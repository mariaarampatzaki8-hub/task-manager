{% extends "base.html" %}{% block title %}Διαχείριση Ομάδων{% endblock %}
{% block content %}
<h1 class="title is-4">Διαχείριση Ομάδων</h1>

<div class="cardish mb-5">
  <form method="post" action="{{ url_for('admin_teams_create') }}" class="is-flex" style="gap:10px">
    <input class="input" name="name" placeholder="Όνομα νέας ομάδας" required>
    <button class="button is-primary">Δημιουργία</button>
  </form>
</div>

<div class="columns is-multiline">
{% for t in teams %}
  <div class="column is-6">
    <div class="cardish">
      <div class="is-flex is-justify-content-space-between">
        <h2 class="subtitle is-5">{{ t.name }}</h2>
        <form method="post" action="{{ url_for('admin_teams_delete', team_id=t.id) }}">
          <button class="button is-danger is-light" onclick="return confirm('Διαγραφή ομάδας;')">Διαγραφή</button>
        </form>
      </div>

      <form method="post" action="{{ url_for('admin_teams_set_leader', team_id=t.id) }}" class="mb-3 is-flex" style="gap:10px">
        <div class="select is-fullwidth">
          <select name="leader_id">
            <option value="">— Χωρίς leader —</option>
            {% for u in users %}
              <option value="{{ u.id }}" {% if t.leader_id==u.id %}selected{% endif %}>{{ u.name }}</option>
            {% endfor %}
          </select>
        </div>
        <button class="button is-link is-light">Ορισμός Leader</button>
      </form>

      <div class="columns">
        <div class="column">
          <h3 class="mini has-text-weight-semibold mb-2">Μέλη</h3>
          <ul class="ml-3">
            {% for m in t.members %}
              <li class="is-flex is-justify-content-space-between">
                <span>{{ m.name }}</span>
                <form method="post" action="{{ url_for('admin_teams_remove_member', team_id=t.id, user_id=m.id) }}">
                  <button class="button is-small is-danger is-light">Αφαίρεση</button>
                </form>
              </li>
            {% else %}<li class="mini">Κανένα μέλος</li>{% endfor %}
          </ul>
        </div>
        <div class="column">
          <h3 class="mini has-text-weight-semibold mb-2">Προσθήκη μέλους</h3>
          <form method="post" action="{{ url_for('admin_teams_add_member', team_id=t.id) }}" class="is-flex" style="gap:8px">
            <div class="select is-fullwidth">
              <select name="user_id">
                {% for u in users %}
                  <option value="{{ u.id }}">{{ u.name }}</option>
                {% endfor %}
              </select>
            </div>
            <button class="button is-primary is-light">Προσθήκη</button>
          </form>
        </div>
      </div>

    </div>
  </div>
{% endfor %}
</div>
{% endblock %}
